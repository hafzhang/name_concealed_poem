下面给你一份**可以直接拿去做的完整产品方案**，不是概念稿，而是**个人程序员可独立完成、7–14 天能上线的 MVP**。我会从 **定位 → 功能 → 流程 → 技术 → 变现 → 风控** 一步一步拆。

---

# 一、产品定位

### 产品名（工作名）

**「姓名藏诗 · 国风书法生成器」**

### 一句话介绍

> 输入你的名字，生成专属藏头诗，并自动转化为国风书法作品。

### 核心人群

* 18–35 岁：社交分享、头像、审美表达
* 家庭用户：孩子起名、祝福
* 节日场景：春节、生日、毕业、婚礼

---

# 二、核心功能模块（MVP）

## 1️⃣ 输入模块（极简）

* 姓名输入框（2–4 汉字）
* 实时校验（非汉字提示）

## 2️⃣ 风格选择模块

### 书法风格（MVP 精选 4 种）

> **⚠️ 版权预警**：必须使用**免费可商用**字体（如：王汉宗系列、庞门正道、江西拙楷等）或购买授权。

*   **楷书**: 端正大气（适合长辈/正式场合）
*   **行书**: 飘逸流畅（适合大多数人）
*   **草书**: 狂野奔放（适合艺术表达）
*   **隶书**: 古朴厚重（适合历史感）

### 气质（简化为 4 种）

*   **儒雅**: 意象多用琴棋书画、梅兰竹菊
*   **豪放**: 意象多用山河、长剑、烈酒
*   **温婉**: 意象多用流水、落花、明月
*   **禅意**: 意象多用松柏、清茶、孤峰

> 技术要点：减少选项可以降低用户的决策成本，同时减轻 Prompt 调试工作量。

---

## 3️⃣ 生成引擎（核心）

### A. 藏头诗生成（文本 AI）

* 五言 / 七言（自动控制）
* 严格首字校验
* 自动纠错（不合格重试）

### B. 书法图片生成 (渲染引擎)

*   **竖排版式**: 核心国风元素。
*   **宣纸背景**: 米黄、洒金、大红。
*   **自动落款**: 姓名 + 干支纪年 (如：乙巳年)。
*   **数字化装裱 (新增)**:
    *   *无框 (None)*: 纯宣纸效果 (适合头像)。
    *   *绫罗卷轴 (Silk Scroll)*: 经典两头卷轴，古韵十足。
    *   *红木画框 (Redwood)*: 沉稳深色实木，适合壁纸。
    *   *金丝楠木 (Golden Wood)*: 浅色温润木纹，尊贵典雅。
    *   *云纹锦缎 (Cloud Brocade)*: 四周织锦包裹，华丽喜庆。
    *   *极简黑框 (Modern Black)*: 细边黑框，新中式风格。

---

## 4️⃣ 结果页（爽点所在）

### 展示内容

* 藏头诗文本（可复制）
* 国风书法图片（预览）

### 操作按钮

* 分享（生成分享卡）
* 下载（低清免费）
* 升级高清（付费）

---

# 三、用户流程（优化版 - 游客优先）

为了降低门槛，采用 **“先尝后买，用完即走”** 的策略，**完全不需要强制登录**。

```mermaid
graph TD
    A[首页] --> B(输入姓名 + 选择风格)
    B --> C[点击生成]
    C --> D{判断次数}
    D -- 有剩余(默认3次) --> E[生成诗句 + 预览]
    D -- 次数用尽 --> F[提示登录/付费解锁]
    E --> G[生成图片]
    G --> H[保存到本地]
    H -.-> I[引导登录 (可选): "登录后永久保存记录"]
```

> **核心策略：设备指纹 (Device Fingerprint)**
> *   利用浏览器缓存 (LocalStorage) 生成一个唯一的 `Guest ID`。
> *   用户首次访问即视为“游客”，自动获得 3 次免费额度。
> *   只有当用户需要 **“购买更多次数”** 或 **“跨设备同步”** 时，才弹出登录框（微信/手机号）。


---

# 四、技术实现方案（2025 极速开发版）

## 核心技术栈（推荐）

*   **框架**: Next.js 14+ (App Router) - 全栈能力，部署方便 (Vercel)
*   **UI 组件**: Tailwind CSS + Shadcn/ui - 快速构建优美界面
*   **图片生成**: **Satori + @resvg/resvg-js**
    *   *原理*：用 HTML/CSS 写排版，自动转 SVG 再转 PNG。
    *   *优势*：比 Canvas/Pillow 更容易调试布局，支持复杂字体和样式。
*   **数据库**: Vercel Postgres / Supabase (存储生成记录、用户积分)
*   **AI 模型**:
    *   DeepSeek-V3 / GPT-4o-mini (高性价比，中文理解力强)

## 核心流程伪代码

1.  **Step 1: 文本生成**
    *   用户提交姓名 -> API 调用 LLM -> 返回 JSON 诗句 -> **前端展示文本**。
    *   *此时用户可以点击“换一首”或直接修改文字。*
2.  **Step 2: 图片合成**
    *   用户确认无误 -> 前端将最终诗句 + 风格配置发送给后端 -> Satori 渲染 HTML -> 转 PNG。
3.  **Step 3: 交付**
    *   返回图片 URL -> 存入数据库 -> 用户下载/分享。

---

# 五、Prompt 设计（核心资产）

为了保证稳定性，建议强制模型返回 **JSON 格式**。

### 藏头诗 Prompt (System)

```markdown
角色：精通中国传统文化的国学大师
任务：根据用户输入的姓名生成“藏头诗”。

要求：
1. 格式：五言绝句（每句 5 字，共 4 句）。
2. 藏头：每句的第一个字必须依次对应姓名中的字。如果是两字姓名，后两句首字可自由发挥或重复名字；如果是三字姓名，第四句首字自由发挥。
3. 韵律：押韵（平水韵），格律工整。
4. 意象：使用古典意象（如明月、清风、松竹、梅兰），避免现代词汇。
5. 风格：{style}（如：豪放、婉约、田园）。

输出格式（必须为 JSON）：
{
  "poem": [
    "第一句诗...",
    "第二句诗...",
    "第三句诗...",
    "第四句诗..."
  ],
  "explanation": "简短的白话文释义"
}
```

### 字体与排版配置

*   **儒雅/温润**: 颜体 / 启功体 + 米色宣纸背景
*   **豪放/大气**: 榜书 / 狂草 + 洒金红宣纸背景
*   **极简**: 瘦金体 + 纯白留白背景


---

# 六、数据模型 (Schema Design)

> **为什么必须存数据？**
> 1.  **计费核心**: 必须记录用户的剩余次数 (`credits`) 和会员状态 (`is_vip`)，否则无法变现。
> 2.  **降低 AI 成本 (缓存)**: 当用户重复输入同一个名字时，直接从数据库调取历史结果，**省去一次 API 调用费用**。
> 3.  **用户留存**: 允许用户在“我的作品”中找回之前的生成记录。

使用 Supabase / Postgres 的简单设计：

### 1. Users 表 (用户)
| 字段 | 类型 | 说明 |
| :--- | :--- | :--- |
| id | UUID | 主键 |
| openid | String | 微信/第三方 ID |
| credits | Integer | 剩余生成次数 (默认 3) |
| is_vip | Boolean | 是否付费用户 |

### 2. Poems 表 (生成记录)
| 字段 | 类型 | 说明 |
| :--- | :--- | :--- |
| id | UUID | 主键 |
| user_id | UUID | 关联用户 |
| input_name | String | 输入的姓名 |
| poem_content | JSONB | 诗句内容 |
| style_config | JSONB | 风格配置 (字体/背景) |
| image_url | String | 生成图片的存储地址 (Nullable) |
| status | String | 'draft' (仅文本) / 'completed' (已出图) |
| created_at | Timestamp | 生成时间 |

---

# 七、API 接口定义 (Split Flow)

### 1. 生成藏头诗 (Step 1)
*   **Endpoint**: `POST /api/generate-poem`
*   **Body**:
    ```json
    {
      "name": "李清照",
      "style": "ruya" // 气质参数
    }
    ```
*   **Response**:
    ```json
    {
      "success": true,
      "data": {
        "poem": ["李花怒放一树白", "清香四溢入梦来", "照影池边人独立", "好风凭借力上台"],
        "explanation": "释义...",
        "cached": false // 标记是否使用了缓存
      }
    }
    ```

### 2. 生成书法图 (Step 2)
*   **Endpoint**: `POST /api/render-image`
*   **Body**:
    ```json
    {
      "name": "李清照",
      "poem": ["李花怒放一树白", "清香四溢入梦来", "照影池边人独立", "好风凭借力上台"],
      "fontStyle": "kaishu", // 书法字体
      "bgStyle": "rice_paper" // 背景样式
    }
    ```
*   **Response**:
    ```json
    {
      "success": true,
      "data": {
        "imageUrl": "https://...",
        "remainingCredits": 2
      }
    }
    ```

### 3. 获取历史记录
*   **Endpoint**: `GET /api/history`
*   **Query**: `?page=1&limit=10`

---

# 八、变现方案（自然不反感）

## 免费用户

* 低清预览
* 水印
* 每日次数限制

## 付费解锁

* 高清无水印
* 多风格导出
* PDF / 海报尺寸

## 定价建议

* 单次：¥3–6
* 套餐：¥19（10 次）
* 节日特价

---

# 九、内容风控与合规

* 敏感词过滤（名字）
* 禁止政治 / 宗教
* 不生成命理断言
* 明确“文化创作”定位

---

# 十、增长 & 裂变设计

## 分享机制

* 分享图自动带诗
* “你的名字在古诗里长这样”

## SEO 页面

* 示例页（张三 / 李四）
* 关键词：藏头诗生成、姓名诗

---

# 十一、7 天 MVP 执行表

| 天数    | 内容            |
| ----- | ------------- |
| Day 1 | 环境搭建 + Prompt 调试 + 数据库建表 |
| Day 2 | 接入 AI API + 实现藏头诗文本生成 |
| Day 3 | Satori 图片渲染引擎开发 (核心难点) |
| Day 4 | 前端核心页 (输入 + 结果页) |
| Day 5 | 支付接入 + 鉴权逻辑 |
| Day 6 | 优化 UI 细节 + 移动端适配 |
| Day 7 | 上线部署 (Vercel) + 朋友圈冷启动 |

---
